# Bracket algorithm by Tristan and Daniel